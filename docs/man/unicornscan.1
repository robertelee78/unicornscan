'\" t
.\" Manual page for unicornscan
.\" Copyright (C) 2004-2006 Jack Louis <jack@rapturesecurity.org>
.\" Maintained by Robert E. Lee <robert@unicornscan.org> (2025-present)
.de Vb
.ft CW
.nf
..
.de Ve
.ft R

.fi
..
.TH "UNICORNSCAN" "1" "2026-01-05" "unicornscan 0.4.38" "Network Tools"
.SH NAME

.PP
unicornscan \- asynchronous network stimulus delivery/response recording tool
.PP
.SH SYNOPSIS

.PP
.B unicornscan
[\fIOPTIONS\fP]
\fItarget\fP[:\fIports\fP] ...
.PP
.SH DESCRIPTION

.PP
Unicornscan is an asynchronous stateless network scanner designed for scalable,
high-speed network reconnaissance and security auditing. It separates the sending
and receiving of packets into separate processes, enabling packet rates of 25,000+
packets per second on commodity hardware.
.PP
Key features include TCP SYN/connect scanning, UDP scanning with protocol payloads,
ARP discovery, OS fingerprinting via p0f v3 signatures, source spoofing with phantom
IPs, compound scan modes for efficient local network scanning, and TCP traceroute.
.PP
.SH OPTIONS

.TP
\fB\-b, \-\-broken\-crc\fP \fIlayer\fP
Generate invalid checksums on specified layers. Valid values are \fBN\fP (network/IP layer),
\fBT\fP (transport layer), or \fBTN\fP (both). Useful for firewall and IDS testing.
.TP
\fB\-B, \-\-source\-port\fP \fIport\fP
Source port for outgoing packets. Use \fB\-1\fP for random (default), or \fB0\-65535\fP
for a specific port. Scanning from port 53 or 80 may bypass some firewall rules.
.TP
\fB\-c, \-\-proc\-duplicates\fP
Process duplicate responses. Normally duplicates are ignored; this option counts them.
.TP
\fB\-d, \-\-delay\-type\fP \fItype\fP
Timer type for packet rate control. Options: \fB1\fP (tsc \- CPU timestamp counter),
\fB2\fP (gtod \- gettimeofday), \fB3\fP (sleep \- nanosleep). TSC and GTOD are CPU-intensive
but accurate at high rates. Sleep is recommended for background scanning.
.TP
\fB\-D, \-\-no\-defpayload\fP
Do not send default payloads. Only probe ports with protocol-specific payloads defined.
.TP
\fB\-e, \-\-enable\-module\fP \fImodules\fP
Enable output/report modules. Comma-separated list, e.g., \fB\-epgsqldb,osdetect\fP.
Common modules: \fBpgsqldb\fP (PostgreSQL export), \fBosdetect\fP (OS fingerprinting).
Module parameters can follow the name: \fB\-epgsqldb,host=localhost,db=unicornscan\fP.
.TP
\fB\-E, \-\-proc\-errors\fP
Process ICMP errors and TCP RST packets. Shows filtered ports, unreachable hosts,
and other responses that indicate firewall presence.
.TP
\fB\-F, \-\-try\-frags\fP
Attempt IP fragmentation (experimental, may not work on all systems).
.TP
\fB\-G, \-\-payload\-group\fP \fIgroup\fP
Use only payloads from the specified numeric group. Default is 1 (all standard payloads).
.TP
\fB\-h, \-\-help\fP
Display usage information and exit.
.TP
\fB\-H, \-\-hardware\-address\fP \fIMAC\fP
Spoof source MAC address. Format: \fBXX:XX:XX:XX:XX:XX\fP. Only affects local network
traffic; upstream routers will use their own MAC.
.TP
\fB\-i, \-\-interface\fP \fIname\fP
Network interface to use (e.g., eth0, wlan0). Normally auto-detected based on routing.
.TP
\fB\-I, \-\-immediate\fP
Display results immediately as they arrive. Output is terse but real-time.
Not recommended when accuracy is critical, as processing may affect timing.
.TP
\fB\-j, \-\-ignore\-seq\fP \fItype\fP
Ignore TCP sequence validation for specified packet types. \fBA\fP ignores all sequence
checking, \fBR\fP ignores RST sequence numbers. Useful for reset scanning or analyzing
responses from unusual TCP stacks.
.TP
\fB\-l, \-\-logfile\fP \fIfile\fP
Write output to file instead of terminal. Currently only logs main process output,
not sender/receiver process messages.
.TP
\fB\-L, \-\-packet\-timeout\fP \fIseconds\fP
Time to wait for responses after sending completes. Default is 7 seconds. Increase
for high-latency networks or decrease for faster scans of reliable networks.
.TP
\fB\-m, \-\-mode\fP \fImode\fP
Scan mode. See \fBSCAN MODES\fP section below for details.
.TP
\fB\-M, \-\-module\-dir\fP \fIdirectory\fP
Directory containing unicornscan modules. Default is \fI/usr/lib/unicornscan/modules\fP.
.TP
\fB\-N, \-\-do\-dns\fP
Resolve hostnames during reporting phase (after scanning completes).
Not recommended when accuracy is critical.
.TP
\fB\-o, \-\-format\fP \fIstring\fP
Custom output format. Specifiers: \fB%h\fP=host, \fB%p\fP=port, \fB%T\fP=type,
\fB%t\fP=TTL, \fB%s\fP=service name. Example: \fB\-o "%h:%p %T ttl %t"\fP
.TP
\fB\-p, \-\-ports\fP \fIspec\fP
Global port specification. Formats: \fB80\fP (single), \fB1\-1024\fP (range),
\fB22,80,443\fP (list), \fBa\fP (all 65535), \fBp\fP (privileged 1\-1024),
\fBq\fP (quick common ports). Can be overridden per-target.
.TP
\fB\-P, \-\-pcap\-filter\fP \fIfilter\fP
Additional pcap filter expression for the listener. Combined with mode-specific
default filter. Example: \fB\-P "not port 22"\fP to exclude SSH traffic.
.TP
\fB\-q, \-\-covertness\fP \fIlevel\fP
Covertness level 0\-255 (currently unused, reserved for future stealth features).
.TP
\fB\-Q, \-\-quiet\fP
Suppress terminal output. Use when output goes to a database or file only.
.TP
\fB\-r, \-\-pps\fP \fIrate\fP
Packets per second. This is the total rate, not per-host. Higher rates may cause
packet loss and incomplete results. Start conservatively (300\-1000) and increase
based on network capacity. Maximum depends on hardware and kernel tuning.
.TP
\fB\-R, \-\-repeats\fP \fIn\fP
Repeat the entire scan n times. Improves accuracy by sending multiple probes per port.
Useful for unreliable networks or critical scans.
.TP
\fB\-s, \-\-source\-addr\fP \fIaddress\fP
Source IP address for packets. Use \fBr\fP for random addresses. When spoofing,
use \fBfantaip\fP(1) to respond to ARP for the phantom address and receive replies.
.TP
\fB\-S, \-\-no\-shuffle\fP
Do not randomize port order. Ports are scanned sequentially. Default is shuffled
to reduce detection and distribute load.
.TP
\fB\-t, \-\-ip\-ttl\fP \fIvalue\fP
IP Time-To-Live. Formats: \fB64\fP (fixed), \fB32\-64\fP (range), \fBr32\-128\fP
(random in range). Lower TTL may evade distant IDS; higher ensures packet delivery.
.TP
\fB\-T, \-\-ip\-tos\fP \fIvalue\fP
IP Type-of-Service byte (0\-255). Affects packet priority and routing behavior.
.TP
\fB\-u, \-\-debug\fP \fImask\fP
Debug output mask. Enables verbose internal logging for troubleshooting.
.TP
\fB\-U, \-\-no\-openclosed\fP
Display raw response types instead of translating to "open" or "closed".
.TP
\fB\-v, \-\-verbose\fP
Increase verbosity. Use multiple times (\-vvv) for more detail.
.TP
\fB\-V, \-\-version\fP
Display version information and exit.
.TP
\fB\-w, \-\-savefile\fP \fIfile\fP
Write captured packets to pcap file for later analysis with Wireshark, tcpdump, etc.
.TP
\fB\-W, \-\-fingerprint\fP \fIid\fP
Emulate an OS TCP/IP stack when sending probes. This affects TCP options, window size,
TTL, and other parameters that fingerprinting tools use to identify operating systems.
.RS
.TP
\fB0\fP
Cisco IOS (default) \- TTL 255, window 4128
.TP
\fB1\fP
OpenBSD \- TTL 64, with timestamps
.TP
\fB2\fP
Windows XP \- TTL 128, window 65535
.TP
\fB3\fP
p0f SYN signature \- TTL 255, minimal options
.TP
\fB4\fP
FreeBSD 5.1 \- TTL 64, with SACK and timestamps
.TP
\fB5\fP
nmap-style \- varies based on target analysis
.TP
\fB6\fP
Linux 2.4/2.6 \- TTL 64, window scale, timestamps
.TP
\fB7\fP
Strange TCP \- BGP MD5 option for router evasion
.TP
\fB8\fP
Windows 10/11/Server 2019+ \- TTL 128, modern options
.TP
\fB9\fP
Linux 5.x/6.x \- TTL 64, modern kernel options
.TP
\fB10\fP
macOS/iOS \- TTL 64, Apple-specific options
.TP
\fB11\fP
Android \- TTL 64, Linux 4.x kernel base
.RE
.TP
\fB\-z, \-\-sniff\fP
Sniff mode \- capture and display packets without sending probes.
.TP
\fB\-Z, \-\-drone\-str\fP \fIstring\fP
Drone configuration string for distributed scanning. See cluster documentation.
.PP
.SS GeoIP Options
These options require libmaxminddb and GeoIP databases (see \fBunicornscan-geoip-update\fP(1)).
.TP
\fB\-\-geoip\fP
Enable geographic lookups for discovered hosts.
.TP
\fB\-\-geoip\-provider\fP \fIname\fP
Database provider: \fBmaxmind\fP (default), \fBip2location\fP, \fBipinfo\fP.
.TP
\fB\-\-geoip\-city\-db\fP \fIpath\fP
Path to city database (e.g., /usr/share/GeoIP/dbip-city-lite.mmdb).
.TP
\fB\-\-geoip\-asn\-db\fP \fIpath\fP
Path to ASN database (e.g., /usr/share/GeoIP/dbip-asn-lite.mmdb).
.PP
.SH SCAN MODES

The \fB\-m\fP option selects the scan mode. Basic modes can be combined with
modifiers, and compound modes chain multiple phases together.
.SS Basic Modes
.TP
\fBT\fP
TCP SYN scan (default). Sends SYN packets and analyzes responses.
.TP
\fBU\fP
UDP scan. Sends protocol-specific payloads where available.
.TP
\fBA\fP
ARP scan. Discovers hosts on local network via ARP requests.
.TP
\fBsf\fP
TCP connect scan. Completes full 3-way handshake for banner grabbing.
.TP
\fBtr\fP
TCP traceroute. Maps network path using incrementing TTL values.
.SS TCP Flag Modifiers
For TCP modes, append flag characters to set or clear specific TCP flags.
Uppercase sets the flag, lowercase clears it.
.PP
.nf
\fBS\fP = SYN    \fBs\fP = no SYN
\fBA\fP = ACK    \fBa\fP = no ACK
\fBF\fP = FIN    \fBf\fP = no FIN
\fBR\fP = RST    \fBr\fP = no RST
\fBP\fP = PSH    \fBp\fP = no PSH
\fBU\fP = URG    \fBu\fP = no URG
.fi
.PP
Examples:
.nf
\fB\-mTSF\fP     SYN+FIN (XMAS-like)
\fB\-mTsA\fP     ACK only (firewall mapping)
\fB\-mTsFPU\fP   FIN+PSH+URG (classic XMAS)
.fi
.SS Compound Modes
Chain modes with \fB+\fP to execute multiple phases sequentially. When ARP is the
first phase, subsequent phases only scan hosts that responded to ARP.
.PP
.nf
\fB\-mA+T\fP     ARP discovery, then TCP SYN (only ARP responders)
\fB\-mA+U\fP     ARP discovery, then UDP scan
\fB\-mA+sf\fP    ARP discovery, then TCP connect
\fB\-mA+T+U\fP   ARP, then TCP, then UDP (all filtered by ARP)
.fi
.PP
Compound modes eliminate kernel ARP blocking delays on sparse local networks,
enabling full packet rates even when most target IPs are unused.
.SS Per-Phase Options
Each phase can have independent rate, repeat, and timeout settings:
.PP
.nf
\fB\-mA100:R3:L15+T500\fP
    Phase 1: ARP at 100 PPS, 3 repeats, 15s timeout
    Phase 2: TCP SYN at 500 PPS (uses global -R and -L)
.fi
.PP
Modifiers:
.TP
\fB<pps>\fP
Packets per second (number after mode letter)
.TP
\fB:R<n>\fP
Repeat scan n times
.TP
\fB:L<n>\fP
Receive timeout in seconds
.PP
.SH TARGET SPECIFICATION

Targets are specified as \fIaddress\fP[/\fIcidr\fP][:\fIports\fP].
.TP
\fBAddress formats\fP
192.168.1.1, 10.0.0.0/24, hostname.example.com
.TP
\fBPort formats\fP
80 (single), 1-1024 (range), 22,80,443 (list), a (all), p (privileged), q (quick)
.PP
Examples:
.nf
192.168.1.0/24:80,443
scanme.nmap.org:1-1024
10.0.0.0/8:q
.fi
.PP
.SH EXAMPLES

.TP
\fBunicornscan 192.168.1.0/24\fP
Default TCP SYN scan of local /24 network on common ports.
.TP
\fBunicornscan -r 1000 -Iv 10.0.0.0/24:22,80,443\fP
Fast scan at 1000 PPS with immediate verbose output.
.TP
\fBunicornscan -mU 192.168.1.0/24:53,161\fP
UDP scan for DNS and SNMP services.
.TP
\fBunicornscan -mA+T -r 10000 192.168.1.0/24:1-1024\fP
Compound mode: ARP discovery then TCP SYN on responders only.
High packet rate is sustainable because non-existent hosts are filtered.
.TP
\fBunicornscan -epgsqldb,osdetect -I 192.168.1.0/24\fP
Scan with OS detection, storing results in PostgreSQL database.
.TP
\fBunicornscan -mtr 8.8.8.8:443\fP
TCP traceroute to Google DNS on port 443.
.TP
\fBunicornscan -W 9 -r 500 target.com:80\fP
Scan emulating Linux 5/6 TCP fingerprint.
.TP
\fBfantaip -i eth0 192.168.1.250 &\fP
.br
\fBunicornscan -s 192.168.1.250 -I target.com:80\fP
Scan from spoofed source address using phantom IP.
.PP
.SH FILES

.TP
\fI/etc/unicornscan/unicorn.conf\fP
Main configuration file with default settings.
.TP
\fI/etc/unicornscan/modules.conf\fP
Module parameters including database connection settings.
.TP
\fI/etc/unicornscan/payloads.conf\fP
Protocol payloads for TCP and UDP scanning.
.TP
\fI/etc/unicornscan/ports.txt\fP
Port number to service name mappings.
.TP
\fI/etc/unicornscan/oui.txt\fP
MAC address prefix to vendor mappings.
.TP
\fI/usr/share/GeoIP/*.mmdb\fP
MaxMind-format GeoIP databases for geographic lookups.
.PP
.SH SEE ALSO

\fBfantaip\fP(1), \fBunibrow\fP(1), \fBunicornscan-alicorn\fP(1),
\fBunicornscan-geoip-update\fP(1), \fBunicorn.conf\fP(5)
.PP
.SH REPORTING BUGS

Report bugs at https://github.com/robertelee78/unicornscan/issues
.PP
.SH COPYRIGHT

Copyright (C) 2004-2006 Jack Louis <jack@rapturesecurity.org>
.br
Maintained by Robert E. Lee <robert@unicornscan.org> (2025-present)
.PP
This is free software; see the source for copying conditions. There is NO warranty;
not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
.PP
.SH HISTORY

Unicornscan was created by Jack Louis at Rapture Security (later Outpost24) as a
high-performance asynchronous network scanner. Development resumed in 2025 with
modernization for current Linux distributions and new features including compound
scan modes, OS fingerprinting, GeoIP integration, and the Alicorn web interface.
