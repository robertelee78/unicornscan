include ../Makefile.inc

all: unicornscan.1

unicornscan.dvi: unicornscan.tex
	latex unicornscan.tex

unicornscan.pdf: unicornscan.dvi
	pdflatex unicornscan.tex

# Man page is pre-built in source tree; only regenerate if latex2man is available
unicornscan.1: unicornscan_man.tex
	@if command -v latex2man >/dev/null 2>&1; then \
		latex2man unicornscan_man.tex unicornscan.1; \
	elif [ -f unicornscan.1 ]; then \
		echo "Using pre-built man page"; \
	else \
		echo "Error: latex2man not found and no pre-built man page"; exit 1; \
	fi

install: unicornscan.1
	mkdir -p $(DESTDIR)/$(mandir)/man1
	$(INSTALL_PROGRAM) -m 644 unicornscan.1 $(DESTDIR)/$(mandir)/man1/@targetname@.1

clean:
	rm -f *.aux *.dvi *.ps *.log

distclean: clean
	rm -f unicornscan.dvi *.log

uninstall:
	rm -f $(DESTDIR)/$(mandir)/man1/@targetname@.1
