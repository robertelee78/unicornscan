unicornscan (0.4.44-1) unstable; urgency=medium

  * Update etc/ports.txt from latest IANA data (Jan 2026)

 -- Robert E. Lee <robert@unicornscan.org>  Mon, 20 Jan 2026 10:00:00 -0800

unicornscan (0.4.43-1) unstable; urgency=medium

  * Packaging consistency and FHS compliance
    - Standardize Alicorn paths across all package formats:
      Static files: /usr/share/unicornscan/alicorn
      Runtime data: /var/lib/unicornscan/alicorn
    - Fix docker-compose --env-file flag for credentials in separate directory
    - Add nodejs to Arch optdepends and RPM Suggests
    - Sync Kali packaging with upstream FHS paths

 -- Robert E. Lee <robert@unicornscan.org>  Fri, 16 Jan 2026 07:00:00 -0800

unicornscan (0.4.42-1) unstable; urgency=medium

  * ASN + CIDR Hierarchical Grouping in Alicorn Web UI
    - Smart search now detects ASN queries (e.g., AS13335, AS15169)
    - Hosts can be filtered by Autonomous System Number
    - Network topology view groups hosts by ASN with organization labels
    - CIDR subnet grouping with automatic /24 inference for ungrouped hosts
    - Force-directed graph layout clusters related network blocks together

  * Multi-Scan Comparison ASN Support
    - Export formats (JSON, CSV, Markdown) now include ASN grouping data
    - Host diffs include ASN number, organization, and CIDR group fields
    - ASN distribution summary in exported reports

  * Topology View Improvements
    - Removed manual "Aggregate by /24" toggle button
    - Auto-aggregation still triggers for large datasets (>500 nodes)
    - Cleaner interface with ASN labels on network clusters

 -- Robert E. Lee <robert@unicornscan.org>  Wed, 15 Jan 2026 16:45:00 -0800

unicornscan (0.4.41-1) unstable; urgency=high

  * CRITICAL: Fix geoip-api missing from .deb packages built by GitHub Actions
    - GitHub Actions workflow was NOT using debian/rules for package creation
    - It had inline manual file copying that was never updated for geoip-api
    - Added geoip-api directory and files to release.yml workflow
    - Added unicornscan-geoip-update script to release.yml workflow
    - Fixed geoip-api source file permissions (were 0600, now 0644)

 -- Robert E. Lee <robert@unicornscan.org>  Mon, 06 Jan 2026 03:30:00 -0800

unicornscan (0.4.40-1) unstable; urgency=medium

  * Add GeoIP API Docker service for live IP lookups
    - New geoip-api service on port 3001 for frontend live lookups
    - Supports DB-IP, MaxMind GeoLite2/GeoIP2, IP2Location, IPinfo databases
    - REST API: /health, /info, /lookup/:ip, POST /lookup (batch)
    - Mounts /usr/share/GeoIP and /var/lib/GeoIP from host
    - Auto-starts with unicornscan-alicorn start

  * Package fixes
    - Add geoip-api directory to deb and rpm packages
    - Add geoip service to docker-compose.standalone.yml

 -- Robert E. Lee <robert@unicornscan.org>  Sun, 05 Jan 2026 14:30:00 -0800

unicornscan (0.4.39-1) unstable; urgency=medium

  * Multi-Scan Comparison Feature (Major)
    - ComparisonDashboard with 4 visualization modes (side-by-side, timeline,
      unified diff, matrix heatmap)
    - Saved comparisons with notes and bookmark functionality
    - Export to CSV, JSON, and Markdown formats
    - Service banner diff tracking and TTL change detection
    - Compatibility filtering for selecting comparable scans
    - Performance optimization with React.memo and pagination

  * GeoIP Improvements
    - Live GeoIP fallback for hosts without stored data
    - GeoIP v13 schema migration
    - Clickable ASN column links to bgp.he.net

  * Accessibility & UI Improvements
    - WCAG 2.1 AA compliance across entire UI
    - Statistics page redesign with scan performance metrics
    - Port activity heatmap with adaptive time granularity
    - Collapsible category groups in heatmap
    - Fixed color contrast for charts, badges, popovers

  * Testing & Quality
    - 66+ tests for comparison feature (unit + integration)
    - Port activity heatmap component tests
    - Port category utility tests
    - Fixed TypeScript compilation errors

  * Documentation
    - Modernized man page with complete documentation
    - Scan comparison user guide and technical spec
    - Replaced LaTeX man page with hand-maintained troff

  * Bug Fixes
    - Fix timezone mixing bug in usePortActivityHeatmap hook
    - Fix Docker healthcheck using 127.0.0.1 instead of localhost
    - Fix port_count using wrong column in database views
    - Fix topology filter controls and filtering logic

 -- Robert E. Lee <robert@unicornscan.org>  Sun, 05 Jan 2026 04:58:00 -0800

unicornscan (0.4.38-1) unstable; urgency=medium

  * Fix global topology page to fetch traceroute data from all scans
  * Add hops and scanner queries to useGlobalTopology() hook
  * Change scanner node size to match other nodes (color only distinction)
  * Add extractPrefixFromTarget() for hostname-based CIDR detection

 -- Robert E. Lee <robert@unicornscan.org>  Sat, 04 Jan 2026 04:20:00 -0800

unicornscan (0.4.37-1) unstable; urgency=medium

  * Add TracerouteTab component for TCPtrace (-mtr) scan visualization
  * Fix traceroute data not storing - make uni_hops.ipreport_id nullable
  * Add useHops hook with fallback to implicit hops from uni_ipreport
  * Add getHops() and getImplicitHopsForScan() to database client

 -- Robert E. Lee <robert@unicornscan.org>  Sat, 03 Jan 2026 19:50:40 -0800

unicornscan (0.4.36-1) unstable; urgency=medium

  * Fix topology edges: chain pattern instead of star pattern for traceroute
  * Add OS fingerprints for Xerox printers and Signify/Philips Hue
  * Update AUTHORS and improve modules.conf install handling
  * Code cleanup: remove unused imports from test files

 -- Robert E. Lee <robert@unicornscan.org>  Fri, 03 Jan 2026 21:00:00 -0800

unicornscan (0.4.35-1) unstable; urgency=medium

  * Fix MODE_TCPTRACE display in Alicorn - now shows "tr" instead of "?"
  * Fix modules.conf permissions to 600 (was 755, exposing credentials)
  * Preserve existing modules.conf on install (installs as .new if exists)
  * Add debian/conffiles for proper dpkg config file handling

 -- Robert E. Lee <robert@unicornscan.org>  Fri, 03 Jan 2026 16:15:00 -0800

unicornscan (0.4.34-1) unstable; urgency=medium

  * MTR Mode (TCP Traceroute) - Phase 2 Complete
    - New -mtr flag for TCP traceroute path discovery
    - Trace session bookkeeping with hop-by-hop ICMP correlation
    - Database integration: trace paths stored in uni_hops table
    - MTR-style clean output without packet-level noise
  * Fix duplicate hop insertions in database
  * Fix spurious hops 12-30 appearing with destination IP
  * CIDR-based clustering for topology visualization
  * "Has Banners" filter on hosts page

 -- Robert E. Lee <robert@unicornscan.org>  Fri, 03 Jan 2026 00:00:00 -0800

unicornscan (0.4.33-1) unstable; urgency=medium

  * Alicorn frontend: Add smart unified search to hosts page
    - Auto-detects search type: port, CIDR, IP prefix, MAC, regex, text
    - Search across all host fields: IP, hostname, MAC, OS, banners, notes
    - Port search finds hosts with specific open ports
    - CIDR/IP prefix filtering for network range queries
    - Regex patterns for advanced banner matching
    - Match highlighting and field indicators in results
    - Lazy-loaded search indexes for optimal performance
    - Comprehensive test coverage (112 tests)
  * Alicorn frontend: Improve theme colors and readability
    - Enhanced contrast for chart components
    - Updated sidebar, timeline, and topology styling
  * Documentation: Update compound mode examples and diagram formatting

 -- Robert E. Lee <robert@unicornscan.org>  Fri, 03 Jan 2026 00:00:00 -0800

unicornscan (0.4.32-1) unstable; urgency=medium

  * Fix banner capture in compound mode (-mA+sf)
    - S_DEFAULT_PAYLOAD flag was not preserved across phase transitions
    - Default TCP payload now available in phase 2 for banner grabbing
    - Compound scans now properly capture SSH, FTP, and other banners

 -- Robert E. Lee <robert@unicornscan.org>  Thu, 02 Jan 2026 22:30:00 -0800

unicornscan (0.4.31-1) unstable; urgency=medium

  * Fix banner capture in TCP connect mode (-msf)
    - SYN cookie validation was incorrectly rejecting PSH+ACK packets
    - In connect mode, real TCP connections use actual sequence numbers
    - Connect module's state_tbl now properly receives response data
    - SSH, FTP, and other banner-first protocols now work correctly

 -- Robert E. Lee <robert@unicornscan.org>  Thu, 02 Jan 2026 16:30:00 -0800

unicornscan (0.4.30-1) unstable; urgency=medium

  * Fix OS detection for iOS/macOS 15+ devices
    - Added signatures for modern Apple devices (iOS 15+, macOS 12+)
    - Correct TCP option layout: mss,nop,ws,nop,nop,ts,sok,eol
    - Correct quirks: DF, ID-, TS2+ (not ID+ as in older versions)
    - Window scale values 5-8 covered for modern Apple TCP stacks

  * Fix OS detection for Linux embedded/IoT devices
    - Added signatures for Raspberry Pi, routers, embedded systems
    - Fixed window 29200, option layout mss,nop,nop,sok,nop,ws

  * Add deduplication for unknown fingerprint logging
    - Hash-based tracking prevents duplicate log spam
    - Each unique fingerprint prints only once per session

 -- Robert E. Lee <robert@unicornscan.org>  Thu, 02 Jan 2026 15:55:00 -0800

unicornscan (0.4.29-1) unstable; urgency=medium

  * Fix Dashboard "Hosts Discovered = 0" bug
    - Now correctly counts unique hosts from uni_ipreport responses
    - Removed stale time filter on uni_hosts table

  * Improve Dashboard chart usability
    - Add dual Y-axes to Scan Activity chart (Scans left, Responses right)
    - Protocol Distribution: show scan IDs on X-axis, clickable navigation
    - Unique Ports now counts (port, protocol) pairs for accuracy
    - Protocol Breakdown based on unique (host, port) pairs per protocol

  * Fix Host Detail page
    - Remove redundant "Port Observations" stat
    - Fix "Responding Ports" to show unique port:protocol pairs

  * Add banner display to Hosts pages
    - Expandable rows show service banners
    - Aggregated port history with smart banner handling

  * Fix duplicate key constraint violations in compound mode scans

  * Fix port expand/collapse and duplicate IP display issues

  * Fix ScanTable duration display for in-progress scans (e_time=0)

 -- Robert E. Lee <robert@unicornscan.org>  Thu, 02 Jan 2026 15:30:00 -0800

unicornscan (0.4.28-1) unstable; urgency=medium

  * Rename uni_scans table to uni_scan (singular, Jack Louis naming convention)
    - Table: uni_scans → uni_scan
    - Column: scans_id → scan_id throughout schema
    - All foreign keys and constraints updated
    - BREAKING: Requires database recreation or migration

  * Update Alicorn frontend for scan_id consistency
    - All TypeScript types updated to use scan_id
    - Hooks, components, and export utilities updated
    - 329 tests passing

 -- Robert E. Lee <robert@unicornscan.org>  Thu, 02 Jan 2026 09:30:00 -0800

unicornscan (0.4.27-1) unstable; urgency=medium

  * Add OS fingerprint data to v_hosts view
    - OS family, name, version, and device type now included in hosts view
    - Alicorn frontend now displays OS info on hosts page
    - Fixed: OS detection results were being stored but not displayed

 -- Robert E. Lee <robert@unicornscan.org>  Wed, 01 Jan 2026 21:00:00 -0800

unicornscan (0.4.26-1) unstable; urgency=medium

  * Fix pgsql_escstr static buffer bugs (critical)
    - Fixed 3 functions with consecutive pgsql_escstr calls that clobbered
      the static buffer, causing data corruption in database inserts:
      - pgsql_insert_service() - 5 fields now use local buffers
      - pgsql_insert_os_fingerprint() - 6 fields now use local buffers
      - pgsql_insert_geoip() - 14 fields now use local buffers
    - Root cause of uni_hosts table not being populated

  * Add CODING_STANDARDS.md
    - Documents Jack Louis's 2004-2006 static buffer patterns
    - Prevents future developers from repeating this class of bug

  * Fix MAC capture for IP reports
    - Remove broken subnet check that prevented MAC capture
    - MAC now correctly captured from Ethernet header for all responses

  * Fix TCP flags display in Alicorn frontend
    - Use report.type field (TCP header flags) not report.flags (CRC errors)
    - Fixed in ResultsTab, HostsTab, hooks, and all export utilities

  * Build system fixes
    - Fix parse.y bison warnings (duplicate token declarations)
    - Fix parse Makefile race condition in parallel builds

 -- Robert E. Lee <robert@unicornscan.org>  Wed, 01 Jan 2026 20:00:00 -0800

unicornscan (0.4.25-2) unstable; urgency=medium

  * Alicorn frontend fixes (16 broken windows resolved)
    - Fix TCP flags using wrong IpReport field in 3 components
    - Fix port history flags using wrong field (subtype→flags)
    - Standardize on port_count field (deprecate open_port_count)
    - Add IP-based host routing for consistency across views
    - Fix N+1 query issues with optimized database methods
    - Add accessible Radix tooltips replacing HTML title attributes
    - Consolidate duplicate formatMac utility functions
    - Fix MAC display in host tables and detail views
    - Add proper null handling for optional host.ip_addr field

 -- Robert E. Lee <robert@unicornscan.org>  Thu, 02 Jan 2026 00:50:00 -0800

unicornscan (0.4.25-1) unstable; urgency=medium

  * MAC address capture for local network targets (schema v9)
    - Captures Ethernet source MAC from response packets for L2-local hosts
    - New is_local_target() function detects hosts reachable without gateway
    - MAC stored in uni_ipreport.eth_hwaddr column (MACADDR type)
    - MAC<->IP history tracking for IP reports (like ARP scans)
    - %M and %o format specifiers now work for IP reports with MAC
    - Alicorn UI displays MAC column in IP reports table
    - Automatic v8->v9 migration adds eth_hwaddr column

 -- Robert E. Lee <robert@unicornscan.org>  Wed, 01 Jan 2026 14:45:00 -0800

unicornscan (0.4.24-1) unstable; urgency=medium

  * Store target specification in database (schema v7)
    - Add target_str column to uni_scans table for original command line targets
    - Shows "192.168.1.0/24" or "scanme.nmap.org" in web UI
    - Automatic migration from v6 schema adds column to existing databases
    - Alicorn UI displays target in scan list and detail views

 -- Robert E. Lee <robert@unicornscan.org>  Wed, 01 Jan 2026 09:47:00 -0800

unicornscan (0.4.23-1) unstable; urgency=medium

  * Fix orphan Docker volume detection on reinstall
    - Detects when postgres volume exists but .env is missing
    - Gives clear error message with reset instructions
    - Prevents password mismatch causing PostgREST auth failures

 -- Robert E. Lee <robert@unicornscan.org>  Thu, 01 Jan 2026 01:30:00 -0800

unicornscan (0.4.22-2) unstable; urgency=medium

  * Fix pgsqldb schema bug: tcpflags -> tcphdrflgs for uni_scan_phases
  * Improve modules.conf update with proper error handling and verification
  * Remove MySQL database module completely (unmaintained deadweight)
  * Remove legacy www-front-end PHP code (replaced by Alicorn React UI)
  * unicornscan-alicorn now reports exactly what fails during password setup

 -- Robert E. Lee <robert@unicornscan.org>  Thu, 01 Jan 2026 00:00:00 -0800

unicornscan (0.4.22-1) unstable; urgency=medium

  * unicornscan-alicorn generates random password on first start
  * Auto-configure modules.conf so -epgsqldb just works
  * Add 'unicornscan-alicorn password' command to show password
  * Simpler workflow: start web UI, run scan with -epgsqldb

 -- Robert E. Lee <robert@unicornscan.org>  Wed, 31 Dec 2025 23:20:00 -0800

unicornscan (0.4.21-1) unstable; urgency=medium

  * Remove Supabase cloud service dependency - now uses pure PostgreSQL
  * Add secure random password generation (no default passwords)
  * Update Alicorn frontend to use @supabase/postgrest-js directly
  * Add docker-init.sh script for secure Docker deployments

 -- Robert E. Lee <robert@unicornscan.org>  Wed, 31 Dec 2025 22:55:00 -0800

unicornscan (0.4.20-1) unstable; urgency=medium

  * Include Alicorn web UI for viewing scan results
  * Add unicornscan-alicorn command to manage Docker web stack
  * Add Docker Compose configuration for PostgreSQL + PostgREST + Alicorn
  * Add suggested dependency on docker.io
  * Post-install script displays web UI usage instructions

 -- Robert E. Lee <robert@unicornscan.org>  Wed, 31 Dec 2025 21:30:00 -0800

unicornscan (0.4.19-1) unstable; urgency=medium

  * Update PostgreSQL schema to v6 with GeoIP integration
  * Add uni_geoip table for geographic and network metadata
  * Add v_geoip and v_geoip_stats views for GeoIP analytics
  * Add indexes and RLS policies for GeoIP data

 -- Robert E. Lee <robert@unicornscan.org>  Tue, 31 Dec 2025 20:00:00 -0800

unicornscan (0.4.18-1) unstable; urgency=medium

  * Fix priority work dispatch delay causing banner grab failures on larger
    target ranges (/27+) in compound mode with sf (banner grabbing)

 -- Robert E. Lee <robert@unicornscan.org>  Fri, 27 Dec 2025 21:00:00 -0800

unicornscan (0.4.17-1) unstable; urgency=medium

  * Fix sf mode in compound mode not sending SYN flag
  * Fix phantom IP (-s) not preserved in compound mode phases
  * Fix phase 2 inheriting config file PPS instead of global -r

 -- Robert E. Lee <robert@unicornscan.org>  Fri, 27 Dec 2025 19:00:00 -0800

unicornscan (0.4.8-1) unstable; urgency=medium

  * New upstream release
  * Fix TCP reassembly buffer underflow causing heap corruption
  * Fix NULL pointer dereferences in pgsql module
  * Add PostgreSQL cloud database support via PostgREST
  * Modernize p0f integration to v3
  * Enhanced UDP payloads from nmap-payloads
  * Fix compilation on modern Linux (GCC 13+)
  * Modernize fantaip for WiFi interfaces

 -- Robert E. Lee <robert@unicornscan.org>  Fri, 20 Dec 2025 09:00:00 -0800
